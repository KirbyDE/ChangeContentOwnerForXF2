<xf:macro name="action_link" arg-content="!" arg-route="!" arg-supportsActionBarMenu="{{ true }}">
	<xf:if contentcheck="true">
		<xf:contentcheck>
			<xf:if is="$content.canChangeOwner() && $content.canChangeDate()">
				<a href="{{ link($route . '/change-owner', $content) }}"
				   class="actionBar-action actionBar-action--changeOwnerAndDate actionBar-action--menuItem"
				   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_owner_or_date') }}</a>
			<xf:elseif is="$content.canChangeOwner()" />
				<a href="{{ link($route . '/change-owner', $content) }}"
				   class="actionBar-action actionBar-action--changeOwner actionBar-action--menuItem"
				   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_owner') }}</a>
			<xf:elseif is="$content.canChangeDate()" />
				<a href="{{ link($route . '/change-owner', $content) }}"
				   class="actionBar-action actionBar-action--changeDate actionBar-action--menuItem"
				   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_date') }}</a>
			</xf:if>
		</xf:contentcheck>
		<xf:if is="$supportsActionBarMenu">
			<xf:set var="$hasActionBarMenu" value="{{ true }}" />
		</xf:if>
	</xf:if>
</xf:macro>

<xf:macro name="menu_link_row" arg-content="!" arg-route="!">
	<xf:if is="$content.canChangeOwner() && $content.canChangeDate()">
		<a href="{{ link($route . '/change-owner', $content) }}"
		   class="menu-linkRow"
		   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_owner_or_date') }}</a>
	<xf:elseif is="$content.canChangeOwner()" />
		<a href="{{ link($route . '/change-owner', $content) }}"
		   class="menu-linkRow"
		   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_owner') }}</a>
	<xf:elseif is="$content.canChangeDate()" />
		<a href="{{ link($route . '/change-owner', $content) }}"
		   class="menu-linkRow"
		   data-xf-click="overlay">{{ phrase('tckChangeContentOwner_change_date') }}</a>
	</xf:if>
</xf:macro>

<xf:macro name="change_owner_row">
	<xf:textboxrow name="username"
				   label="{{ phrase('tckChangeContentOwner_new_owner') }}"
				   explain="{{ phrase('tckChangeContentOwner_new_owner_name_explain') }}"
				   ac="true"
				   data-single="true" />
</xf:macro>

<xf:macro name="change_date_row" arg-contentDate="{{ null }}" arg-showTimeIntervals="{{ false }}" >
	<xf:css src="tckChangeContentOwner_macros_change_date_row.less" />
	<xf:js addon="TickTackk/ChangeContentOwner" src="ticktackk/changecontentowner/main.js" min="1" />

	<xf:radiorow name="change_time_type">
		<xf:option value="update_datetime" label="{{ phrase('tckChangeContentOwner_new_date') }}" data-hide="true" selected="{{ true }}">
			<xf:dependent>
				<xf:dateinput name="date"
					 data-allow-setting-time="true"
					 data-use-twenty-four-hour="{{ $xf.language.time_format === 'H:i' ? 'true' : 'false' }}"
					 value="{$contentDate}"/>
				
				<p class="formRow-explain">{{ phrase('tckChangeContentOwner_new_date_explain') }}</p>
				
				<xf:if is="$showTimeIntervals">
					<label class="formRow-label">{{ phrase('tckChangeContentOwner_time_interval') }}</label>

					<xf:macro name="time_units"
							  arg-option="{{ $xf.options.tckChangeContentOwner_defaultNewDateTimeInterval }}"
							  arg-name="date_time_interval" />	

					<p class="formRow-explain">{{ phrase('tckChangeContentOwner_bump_time_explain') }}</p>
				</xf:if>
			</xf:dependent>
		</xf:option>
		<xf:option value="bump_time" data-hide="true" label="{{ phrase('tckChangeContentOwner_bump_time') }}" data-hide="true">
			<xf:dependent>
				<xf:macro name="time_units"
							  arg-option="{{ $xf.options.tckChangeContentOwner_defaultBumpBy }}"
							  arg-name="bump_time" />	
				
				<p class="formRow-explain">{{ phrase('tckChangeContentOwner_bump_time_explain') }}</p>
			</xf:dependent>
		</xf:option>
	</xf:radiorow>
	
	<script class="js-extraPhrases" type="application/json">
		{
			"midnight": "{{ phrase('midnight')|escape('json') }}",
			"noon": "{{ phrase('noon')|escape('json') }}"
		}
	</script>
</xf:macro>

<xf:macro name="time_units" arg-option="!" arg-name="!">
	<div class="inputGroup inputGroup--numbers">
		<xf:numberbox name="{$name}[hours]" value="{{ $option.hours ?: 0 }}"
					  min="0"
					  units="{{ phrase('units_hours') }}" />
		<span class="inputGroup-splitter"></span>

		<xf:numberbox name="{$name}[minutes]" value="{{ $option.minutes ?: 0 }}"
					  min="0"
					  units="{{ phrase('units_minutes') }}" />
		<span class="inputGroup-splitter"></span>

		<xf:numberbox name="{$name}[seconds]" value="{{ $option.seconds ?: 0 }}"
					  min="0"
					  units="{{ phrase('units_seconds') }}" />
	</div>
</xf:macro>

<xf:macro name="change_rows" arg-handler="!" arg-content="!" arg-showTimeIntervals="{{ false }}">
	<xf:if is="$handler AND $content">
		<xf:if is="$handler.canChangeOwner($content)">
			<xf:macro template="tckChangeContentOwner_macros"
					  name="change_owner_row" />
		</xf:if>
		
		<xf:if is="$handler.canChangeDate($content)">
			<xf:macro template="tckChangeContentOwner_macros"
					  name="change_date_row"
					  arg-contentDate="{{ date($handler.getOldDate($content), 'Y-m-d H:i:s') }}"
					  arg-showTimeIntervals="{{ $showTimeIntervals }}" />
		</xf:if>
	</xf:if>
</xf:macro>